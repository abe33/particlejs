(function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y={}.hasOwnProperty,Z=function(e,t){function r(){this.constructor=e}for(var n in t)Y.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e},et=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};this.particlejs||(this.particlejs={}),R=function(){function e(){this.listeners=[]}return e.prototype.add=function(e,t,n){n==null&&(n=0);if(!this.registered(e,t))return this.listeners.push([e,t,!1,n]),this.sortListeners()},e.prototype.addOnce=function(e,t,n){n==null&&(n=0);if(!this.registered(e,t))return this.listeners.push([e,t,!0,n]),this.sortListeners()},e.prototype.remove=function(e,t){if(this.registered(e,t))return this.listeners.splice(this.indexOf(e,t),1)},e.prototype.removeAll=function(){return this.listeners=[]},e.prototype.indexOf=function(e,t){var n,r,i,s,o,u,a;u=this.listeners;for(r=s=0,o=u.length;s<o;r=++s){a=u[r],i=a[0],n=a[1];if(e===i&&t===n)return r}return-1},e.prototype.registered=function(e,t){return this.indexOf(e,t)!==-1},e.prototype.sortListeners=function(){if(this.listeners.length<=1)return;return this.listeners.sort(function(e,t){var n,r,i;return i=[e[3],t[3]],n=i[0],r=i[1],n<r?1:r<n?-1:0})},e.prototype.dispatch=function(){var e,t,n,r,i,s,o,u,a;n=this.listeners.concat(),a=[];for(s=0,o=n.length;s<o;s++)u=n[s],t=u[0],e=u[1],r=u[2],i=u[3],t.apply(e,arguments),r?a.push(this.remove(t,e)):a.push(void 0);return a},e}(),G=(typeof window!="undefined"&&window!==null?window.requestAnimationFrame:void 0)||(typeof window!="undefined"&&window!==null?window.webkitRequestAnimationFrame:void 0)||(typeof window!="undefined"&&window!==null?window.mozRequestAnimationFrame:void 0)||(typeof window!="undefined"&&window!==null?window.oRequestAnimationFrame:void 0)||(typeof window!="undefined"&&window!==null?window.msRequestAnimationFrame:void 0)||function(e){return setTimeout(e,1e3/60)},h=function(e){function t(e){this.timeScale=e!=null?e:1,t.__super__.constructor.call(this),this.running=!1}return Z(t,e),t.instance=function(){return this._instance||(this._instance=new t)},t.prototype.add=function(e,n,r){r==null&&(r=0),t.__super__.add.call(this,e,n,r);if(this.hasListeners()&&!this.running)return this.start()},t.prototype.remove=function(e,n,r){r==null&&(r=0),t.__super__.remove.call(this,e,n,r);if(this.running&&!this.hasListeners())return this.stop()},t.prototype.hasListeners=function(){return this.listeners.length>0},t.prototype.start=function(){return this.running=!0,this.initRun()},t.prototype.stop=function(){return this.running=!1},t.prototype.initRun=function(){var e=this;return this.time=this.getTime(),G(function(){return e.run()})},t.prototype.run=function(){var e,t,n,r;if(this.running)return(n=this.stats)!=null&&n.begin(),t=this.getTime(),e=(t-this.time)*this.timeScale,this.dispatch(e,e/1e3,t),this.initRun(),(r=this.stats)!=null?r.end():void 0},t.prototype.getTime=function(){return(new Date).getTime()},t}(R),V=function(){function e(e,t,n){this.initializer=e!=null?e:new L,this.action=t!=null?t:new N,this.subSystem=n,this.particlesCreated=new R,this.particlesDied=new R,this.emissionStarted=new R,this.emissionFinished=new R,this.particles=[],this.emissions=[]}return e.prototype.emit=function(e){return this.emissions.push(e),e.system=this,this.startEmission(e)},e.prototype.startEmission=function(e){return e.prepare(0,0,this.getTime()),this.created=[],this.died=[],this.running||this.start(),this.processEmission(e),this.emissionStarted.dispatch(this,e),this.created.length>0&&this.particlesCreated.dispatch(this,this.created),this.died.length>0&&this.particlesDied.dispatch(this,this.died),this.died=null,this.created=null},e.prototype.start=function(){if(!this.running)return h.instance().add(this.tick,this),this.running=!0},e.prototype.stop=function(){if(this.running)return h.instance().remove(this.tick,this),this.running=!1},e.prototype.tick=function(e,t,n){return this.died=[],this.created=[],this.processParticles(e,t,n),this.emitting()&&this.processEmissions(e,t,n),this.created.length>0&&this.particlesCreated.dispatch(this,this.created),this.died.length>0&&this.particlesDied.dispatch(this,this.died),this.died=null,this.created=null},e.prototype.emitting=function(){return this.emissions.length>0},e.prototype.processEmissions=function(e,t,n){var r,i,s,o,u;o=this.emissions.concat(),u=[];for(i=0,s=o.length;i<s;i++)r=o[i],r.prepare(e,t,n),u.push(this.processEmission(r));return u},e.prototype.processEmission=function(e){var t,n,r;r=[];while(e.hasNext())n=e.nextTime(),t=e.next(),this.created.push(t),this.registerParticle(t),this.initializeParticle(t,n),e.finished()?(this.removeEmission(e),r.push(this.emissionFinished.dispatch(this,e))):r.push(void 0);return r},e.prototype.removeEmission=function(e){return this.emissions.splice(this.emissions.indexOf(e),1)},e.prototype.processParticles=function(e,t,n){var r,i,s,o,u;this.action.prepare(e,t,n),o=this.particles.concat(),u=[];for(i=0,s=o.length;i<s;i++)r=o[i],this.action.process(r),r.dead?u.push(this.unregisterParticle(r)):u.push(void 0);return u},e.prototype.initializeParticle=function(e,t){this.initializer.initialize(e),this.action.prepare(t,t/1e3,this.getTime()),this.action.process(e);if(e.dead)return this.unregisterParticle(e)},e.prototype.registerParticle=function(e){return this.particles.push(e)},e.prototype.unregisterParticle=function(e){var t;return this.died.push(e),(t=this.subSystem)!=null&&t.emitFor(e),this.particles.splice(this.particles.indexOf(e),1),e.constructor.release(e)},e.prototype.getTime=function(){return(new Date).valueOf()},e}(),W=function(e){function t(e,n,r,i){this.emissionFactory=r,t.__super__.constructor.call(this,e,n,i)}return Z(t,e),t.prototype.emitFor=function(e){return this.emit(this.emissionFactory(e))},t}(V),x=mixinsjs.Mixin,e=function(e){return e.split(/\s+/g)},v=e("biasInSeconds bias time nextTime"),B=e("finished"),o=function(){return/^function\s*([^(]+\s*)*\([^)]*\)\s*\{\}/gm},q=function(){return/(^\s*|\s*$)/gm},j=function(){return/return\s*([^;]+);/},$=function(){return RegExp("this\\.("+v.join("|")+")","gm")},m=function(){var e;return e=v.map(function(e){return""+e+"\\s*=\\s*"+e}),RegExp("("+e.join("|")+");","gm")},p=function(e){var t;return e==null&&(e={}),t=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Z(n,t),n.prototype.sourceFragment=function(t){var n,r,i,s,u,a=this;return r=t==="constructor",u=this[t],r&&e["super"]&&(u=u.__super__.constructor),u=u.toString(),o().test(u)?"":r&&e.noconstructor?"":(n=u.split("\n"),n.shift(),n.pop(),r&&(n=n.filter(function(e){return!RegExp(""+v.join("|")).test(e)})),u=n.join("\n"),i=function(t){var n;return n=RegExp("this\\.("+e.inlinedProperties.join("|")+")\\s*=[^\\n]+","g"),t.replace(n,"")},s=function(t){var n;return n=RegExp("this\\.("+e.inlinedProperties.join("|")+")","g"),t.replace(n,function(e,t){return a[t]})},u=u.replace($(),"$1").replace(m(),""),e.inlinedProperties!=null&&(u=i(u),u=s(u)),et.call(B,t)>=0?u=u.replace(j(),""+t+" = $1;"):u=u.replace(j(),"$1;"),u.replace(q(),""))},n}(x)},x=mixinsjs.Mixin,H=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Z(t,e),t.included=function(e){return e.resetPools=function(){return this.allocated=[],this.pooled=[]},e.get=function(t){var n,r,i;t==null&&(t={}),this.pooled.length>0?n=this.pooled.shift():n=new e,typeof n.init=="function"&&n.init();for(r in t)i=t[r],n[r]=i;return this.allocated.push(n),n},e.release=function(e){var t;return t=this.allocated.indexOf(e),e.dispose(),this.allocated.splice(t,1),this.pooled.push(e)},e.resetPools()},t}(x),x=mixinsjs.Mixin,F=chancejs.Random,S=chancejs.MathRandom,i=new F(new S),I=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Z(t,e),t.prototype.initRandom=function(){return this.random||(this.random=i)},t}(x),t=function(){function e(){}return e.prototype.prepare=function(e,t,n){this.bias=e,this.biasInSeconds=t,this.time=n},e}(),s=function(){function e(e){this.surfaces=e,Object.prototype.toString.call(this.surface).indexOf("Array")===-1&&(this.surfaces=[this.surfaces])}return e.prototype.prepare=function(){},e.prototype.process=function(e){var t,n,r,i;i=this.surfaces;for(n=0,r=i.length;n<r;n++){t=i[n];if(t.contains(e.position))return e.die()}},e}(),D=geomjs,l=function(e){function t(e){this.vector=e!=null?e:new D}return Z(t,e),t.prototype.process=function(e){return e.velocity.x+=this.vector.x*this.biasInSeconds,e.velocity.y+=this.vector.y*this.biasInSeconds},t}(t),c=function(e){function t(e){this.amount=e!=null?e:1}return Z(t,e),t.prototype.process=function(e){var t,n;return t=e.velocity.x*this.biasInSeconds*this.amount,n=e.velocity.y*this.biasInSeconds*this.amount,e.velocity.x-=t,e.velocity.y-=n},t}(t),b=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Z(t,e),t.prototype.process=function(e){e.life+=this.bias;if(e.life>=e.maxLife)return e.die()},t}(t),w=function(e){function t(e){this.actions=e!=null?e:[]}return Z(t,e),t.prototype.prepare=function(e,t,n){var r,i,s,o,u;o=this.actions,u=[];for(i=0,s=o.length;i<s;i++)r=o[i],u.push(r.prepare(e,t,n));return u},t.prototype.process=function(e){var t,n,r,i,s;i=this.actions,s=[];for(n=0,r=i.length;n<r;n++)t=i[n],s.push(t.process(e));return s},t}(t),U=mixinsjs.Sourcable,r=mixinsjs.Cloneable,Q=mixinsjs.include,T=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Z(t,e),Q([p({noconstructor:!0}),r(),U("particlejs.Move")])["in"](t),t.prototype.process=function(e){return e.lastPosition.x=e.position.x,e.lastPosition.y=e.position.y,e.position.x+=e.velocity.x*this.biasInSeconds,e.position.y+=e.velocity.y*this.biasInSeconds},t}(t),N=function(){function e(){}return e.prototype.prepare=function(){},e.prototype.process=function(){},e}(),n=function(){function e(e){this.rate=e!=null?e:1,this.count=0,this.rest=0,this.offset=1}return e.prototype.prepare=function(e,t,n){return this.rest+=t*this.rate,this.count=Math.floor(this.rest),this.rest-=this.count,this.count+=this.offset,this.offset=0},e}(),f=function(){function e(e){this.count=e!=null?e:1}return e.prototype.prepare=function(){},e}(),C=function(){function e(){}return e.prototype.count=0,e.prototype.prepare=function(){},e}(),u=function(){function e(e,t,n,r,i){this.particleType=e!=null?e:O,this.emitter=t!=null?t:new k,this.timer=n!=null?n:new A,this.counter=r!=null?r:new C,this.initializer=i!=null?i:null}return e.prototype.prepare=function(e,t,n){var r;return this.timer.prepare(e,t,n),r=this.timer.nextTime,this.counter.prepare(r,r/1e3,n),this.currentCount=this.counter.count,this.currentTime=r,this.iterator=0},e.prototype.hasNext=function(){return this.iterator<this.currentCount},e.prototype.next=function(){var e,t;return e=this.particleType.get({position:this.emitter.get()}),(t=this.initializer)!=null&&t.initialize(e),this.iterator++,e},e.prototype.nextTime=function(){return this.currentTime-this.iterator/this.currentCount*this.currentTime},e.prototype.finished=function(){return this.timer.finished()},e}(),D=geomjs.Point,k=function(){function e(){}return e.prototype.get=function(){return new D},e}(),_=function(){function e(e,t){this.path=e,this.random=t,this.initRandom()}return I.attachTo(e),e.prototype.get=function(){return this.path.pathPointAt(this.random.get())},e}(),D=geomjs.Point,P=function(){function e(e){this.point=e!=null?e:new D}return e.prototype.get=function(){return this.point.clone()},e}(),X=function(){function e(e,t){this.surface=e,this.random=t,this.initRandom()}return I.attachTo(e),e.prototype.get=function(){return this.surface.randomPointInSurface(this.random)},e}(),a=function(){function e(e,t,n,r,i){this.velocityMin=e!=null?e:0,this.velocityMax=t!=null?t:1,this.angleMin=n!=null?n:0,this.angleMax=r!=null?r:Math.PI*2,this.random=i,this.initRandom()}return I.attachTo(e),e.prototype.initialize=function(e){var t,n;return t=this.random["in"](this.angleMin,this.angleMax),n=this.random["in"](this.velocityMin,this.velocityMax),e.velocity.x=Math.cos(t)*n,e.velocity.y=Math.sin(t)*n},e}(),g=function(){function e(e,t,n){this.lifeMin=e,this.lifeMax=t,this.random=n,this.lifeMax==null&&(this.lifeMax=this.lifeMin),this.initRandom()}return I.attachTo(e),e.prototype.initialize=function(e){return this.lifeMin===this.lifeMax?e.maxLife=this.lifeMin:e.maxLife=this.random["in"](this.lifeMin,this.lifeMax)},e}(),E=function(){function e(e){this.initializers=e}return e.prototype.initialize=function(e){var t,n,r,i,s;i=this.initializers,s=[];for(n=0,r=i.length;n<r;n++)t=i[n],s.push(t.initialize(e));return s},e}(),L=function(){function e(){}return e.prototype.initialize=function(){},e}(),M=function(){function e(e,t,n,r){this.subSystem=new W(e,t,n,r)}return e.prototype.initialize=function(e){return this.subSystem.emitFor(e)},e}(),D=geomjs.Point,z=function(){function e(e,t,n,r,i){this.direction=e!=null?e:new D(1,1),this.velocityMin=t!=null?t:0,this.velocityMax=n!=null?n:1,this.angleRandom=r!=null?r:0,this.random=i,this.initRandom()}return I.attachTo(e),e.prototype.initialize=function(e){var t,n;return n=this.random["in"](this.velocityMin,this.velocityMax),t=this.direction.angle(),this.angleRandom!==0&&(t+=this.random.pad(this.angleRandom)),e.velocity.x=Math.cos(t)*n,e.velocity.y=Math.sin(t)*n},e}(),D=geomjs.Point,O=function(){function e(){}return H.attachTo(e),e.prototype.init=function(){return this.dead=!1,this.life=0,this.maxLife=0,this.position=new D,this.lastPosition=new D,this.velocity=new D,this.parasite={}},e.prototype.dispose=function(){return this.position=null,this.lastPosition=null,this.velocity=null,this.parasite=null},e.prototype.die=function(){return this.dead=!0,this.life=this.maxLife},e.prototype.revive=function(){return this.dead=!1,this.life=0},e}(),W=function(e){function t(e,n,r,i){this.emissionFactory=r,t.__super__.constructor.call(this,e,n,i)}return Z(t,e),t.prototype.emitFor=function(e){return this.emit(this.emissionFactory(e))},t}(V),V=function(){function e(e,t,n){this.initializer=e!=null?e:new L,this.action=t!=null?t:new N,this.subSystem=n,this.particlesCreated=new R,this.particlesDied=new R,this.emissionStarted=new R,this.emissionFinished=new R,this.particles=[],this.emissions=[]}return e.prototype.emit=function(e){return this.emissions.push(e),e.system=this,this.startEmission(e)},e.prototype.startEmission=function(e){return e.prepare(0,0,this.getTime()),this.created=[],this.died=[],this.running||this.start(),this.processEmission(e),this.emissionStarted.dispatch(this,e),this.created.length>0&&this.particlesCreated.dispatch(this,this.created),this.died.length>0&&this.particlesDied.dispatch(this,this.died),this.died=null,this.created=null},e.prototype.start=function(){if(!this.running)return h.instance().add(this.tick,this),this.running=!0},e.prototype.stop=function(){if(this.running)return h.instance().remove(this.tick,this),this.running=!1},e.prototype.tick=function(e,t,n){return this.died=[],this.created=[],this.processParticles(e,t,n),this.emitting()&&this.processEmissions(e,t,n),this.created.length>0&&this.particlesCreated.dispatch(this,this.created),this.died.length>0&&this.particlesDied.dispatch(this,this.died),this.died=null,this.created=null},e.prototype.emitting=function(){return this.emissions.length>0},e.prototype.processEmissions=function(e,t,n){var r,i,s,o,u;o=this.emissions.concat(),u=[];for(i=0,s=o.length;i<s;i++)r=o[i],r.prepare(e,t,n),u.push(this.processEmission(r));return u},e.prototype.processEmission=function(e){var t,n,r;r=[];while(e.hasNext())n=e.nextTime(),t=e.next(),this.created.push(t),this.registerParticle(t),this.initializeParticle(t,n),e.finished()?(this.removeEmission(e),r.push(this.emissionFinished.dispatch(this,e))):r.push(void 0);return r},e.prototype.removeEmission=function(e){return this.emissions.splice(this.emissions.indexOf(e),1)},e.prototype.processParticles=function(e,t,n){var r,i,s,o,u;this.action.prepare(e,t,n),o=this.particles.concat(),u=[];for(i=0,s=o.length;i<s;i++)r=o[i],this.action.process(r),r.dead?u.push(this.unregisterParticle(r)):u.push(void 0);return u},e.prototype.initializeParticle=function(e,t){this.initializer.initialize(e),this.action.prepare(t,t/1e3,this.getTime()),this.action.process(e);if(e.dead)return this.unregisterParticle(e)},e.prototype.registerParticle=function(e){return this.particles.push(e)},e.prototype.unregisterParticle=function(e){var t;return this.died.push(e),(t=this.subSystem)!=null&&t.emitFor(e),this.particles.splice(this.particles.indexOf(e),1),e.constructor.release(e)},e.prototype.getTime=function(){return(new Date).valueOf()},e}(),U=mixinsjs.Sourcable,r=mixinsjs.Cloneable,Q=mixinsjs.include,d=function(){function e(){}return Q([p(),r(),U("particlejs.Instant")])["in"](e),e.prototype.prepare=function(){return this.nextTime=0},e.prototype.finished=function(){return!0},e}(),U=mixinsjs.Sourcable,r=mixinsjs.Cloneable,Q=mixinsjs.include,y=function(){function e(e,t){this.duration=e!=null?e:1e3,this.since=t!=null?t:0,this.elapsed=0,this.nextTime=0}return Q([p({inlinedProperties:["duration","since"]}),r("duration","since"),U("particlejs.Limited","duration","since")])["in"](e),e.prototype.prepare=function(e,t,n){return this.firstTime?this.nextTime=e:(this.nextTime=this.since+e,this.firstTime=!0),this.elapsed+=e},e.prototype.finished=function(){return this.elapsed>=this.duration},e}(),A=function(){function e(){}return e.prototype.nextTime=0,e.prototype.prepare=function(){},e.prototype.finished=function(){return!0},e}(),U=mixinsjs.Sourcable,r=mixinsjs.Cloneable,Q=mixinsjs.include,J=function(e){function t(e){t.__super__.constructor.call(this,Infinity,e)}return Z(t,e),Q([p({inlinedProperties:["duration","since"],"super":!0}),r("since"),U("particlejs.Unlimited","since")])["in"](t),t.prototype.finished=function(){return!1},t}(y),K=function(){function e(e){this.particle=e}return e.prototype.prepare=function(e,t,n){return this.nextTime=e},e.prototype.finished=function(){return this.particle.dead},e}(),this.particlejs.Signal=R,this.particlejs.Impulse=h,this.particlejs.System=V,this.particlejs.SubSystem=W,this.particlejs.Inlinable=p,this.particlejs.Poolable=H,this.particlejs.Randomizable=I,this.particlejs.BaseAction=t,this.particlejs.DieOnSurface=s,this.particlejs.Force=l,this.particlejs.Friction=c,this.particlejs.Live=b,this.particlejs.MacroAction=w,this.particlejs.Move=T,this.particlejs.NullAction=N,this.particlejs.ByRate=n,this.particlejs.Fixed=f,this.particlejs.NullCounter=C,this.particlejs.Emission=u,this.particlejs.NullEmitter=k,this.particlejs.Path=_,this.particlejs.Ponctual=P,this.particlejs.Surface=X,this.particlejs.Explosion=a,this.particlejs.Life=g,this.particlejs.MacroInitializer=E,this.particlejs.NullInitializer=L,this.particlejs.ParticleSubSystem=M,this.particlejs.Stream=z,this.particlejs.Particle=O,this.particlejs.SubSystem=W,this.particlejs.System=V,this.particlejs.Instant=d,this.particlejs.Limited=y,this.particlejs.NullTimer=A,this.particlejs.Unlimited=J,this.particlejs.UntilDeath=K}).call(this)